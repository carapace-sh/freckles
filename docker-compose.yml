version: '3'

services:
  build:
    build: .
    command: sh -c 'sh -c "cd /freckles-bin/cmd/freckles  && go build -ldflags=\"-s -w\" -buildvcs=false ."'
    volumes:
      - '.:/freckles-bin/'
      - 'go:/go/'

  elvish:
    build: .
    command: elvish
    volumes:
      - "$HOME/.config/gh:/root/.config/gh:ro"
      - "$HOME/.ssh:/root/.ssh:ro"
      - '.:/freckles-bin/'

volumes:
  go:
